<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lucifex - Garment Visualization</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ­ Lucifex Garment Visualizer</h1>
      <div id="status-bar">
        <div id="status-content">Ready</div>
      </div>
    </header>

    <div class="main-layout">
      <!-- Left Panel - Controls -->
      <div class="left-panel">
        <!-- Tabs -->
        <div class="tabs">
          <button class="tab active" data-tab="avatar">ğŸ‘¤ Avatar</button>
          <button class="tab" data-tab="garment">ğŸ‘• Garment</button>
          <button class="tab" data-tab="combined">ğŸ¯ Combined</button>
          <button class="tab" data-tab="physics">ğŸ§¬ Physics</button>
          <button class="tab" data-tab="environment">ğŸŒ Environment</button>
        </div>

        <!-- Tab Contents -->
        <div class="tab-contents">
          <!-- Avatar Tab -->
          <div id="avatar-tab" class="tab-content active">
            <h3>Avatar Selection</h3>
            
            <div class="section">
              <h4>Presets</h4>
              <div class="preset-grid">
                <button class="avatar-option" data-avatar="male">ğŸ‘¨ Male</button>
                <button class="avatar-option" data-avatar="female">ğŸ‘© Female</button>
              </div>
            </div>

            <div class="section">
              <h4>Custom Avatar</h4>
              <input type="file" id="avatar-file" accept=".glb,.gltf" />
              <div id="avatar-file-info" class="file-info"></div>
            </div>

            <div class="section">
              <h4>Avatar Scale</h4>
              <div class="control-group">
                <input type="range" id="avatar-scale" min="0.5" max="2" step="0.1" value="1" />
                <span id="avatar-scale-value">1</span>x
              </div>
            </div>
          </div>

          <!-- Garment Tab -->
          <div id="garment-tab" class="tab-content">
            <h3>Garment Selection</h3>
            
            <div class="section">
              <h4>Sample Garments</h4>
              <div class="preset-grid">
                <button class="preset-btn" data-garment="tshirt">ğŸ‘• T-Shirt</button>
                <button class="preset-btn" data-garment="tshirt-1">ğŸ‘” T-Shirt 2</button>
              </div>
            </div>

            <div class="section">
              <h4>Custom Garment</h4>
              <input type="file" id="garment-file" accept=".glb,.gltf" />
              <div id="garment-file-info" class="file-info"></div>
            </div>

            <div class="section">
              <h4>Garment Scale</h4>
              <div class="control-group">
                <input type="range" id="garment-scale" min="0.5" max="2" step="0.1" value="1" />
                <span id="garment-scale-value">1</span>x
              </div>
            </div>
          </div>

          <!-- Combined Tab -->
          <div id="combined-tab" class="tab-content">
            <h3>Combined Visualization</h3>
            
            <div id="combination-status" class="combination-status empty">
              <strong>Status:</strong> âŒ Load avatar and garment to combine
            </div>

            <div class="section">
              <h4>Combination Method</h4>
              <div class="preset-grid">
                <button class="preset-btn active" data-combination="overlay">ğŸ”„ Overlay</button>
                <button class="preset-btn" data-combination="merge">ğŸ”— Merge</button>
              </div>
            </div>

            <div class="section">
              <h4>Garment Controls</h4>
              <div class="control-group">
                <label>Scale:</label>
                <input type="range" id="garment-scale-combined" min="0.5" max="2" step="0.1" value="1" />
                <span id="garment-scale-combined-value">1</span>x
              </div>
              <div class="control-group">
                <label>Position Y:</label>
                <input type="range" id="garment-offset-y" min="-2" max="2" step="0.1" value="0" />
                <span id="garment-offset-y-value">0</span>
              </div>
              <div class="control-group">
                <label>Position X:</label>
                <input type="range" id="garment-offset-x" min="-2" max="2" step="0.1" value="0" />
                <span id="garment-offset-x-value">0</span>
              </div>
            </div>

            <div class="section">
              <h4>Avatar Opacity</h4>
              <div class="control-group">
                <input type="range" id="avatar-opacity" min="0" max="1" step="0.1" value="0.7" />
                <span id="avatar-opacity-value">0.7</span>
              </div>
            </div>

            <div class="section">
              <h4>Garment Opacity</h4>
              <div class="control-group">
                <input type="range" id="garment-opacity" min="0" max="1" step="0.1" value="1" />
                <span id="garment-opacity-value">1</span>
              </div>
            </div>

            <div class="section">
              <h4>Actions</h4>
              <button id="generate-combined" class="action-btn">ğŸ¯ Generate Combined</button>
              <button id="reset-combination" class="action-btn">ğŸ”„ Reset</button>
            </div>
          </div>

          <!-- Physics Tab -->
          <div id="physics-tab" class="tab-content">
            <h3>Physics Simulation</h3>
            
            <div id="physics-status" class="status-display">
              <strong>Physics Engine:</strong> Ready
            </div>

            <div class="section">
              <h4>Physics Controls</h4>
              <button id="physics-toggle" class="action-btn">ğŸ§¬ Enable Physics</button>
              <button id="physics-reset" class="action-btn">ğŸ”„ Reset Physics</button>
              <button id="reset-cloth" class="action-btn">ğŸ“ Reset Cloth Position</button>
            </div>

            <div class="section">
              <h4>Physics Settings</h4>
              <div class="control-group">
                <label>Cloth Stiffness:</label>
                <input type="range" id="cloth-stiffness" min="0.1" max="1" step="0.1" value="0.3" />
                <span id="cloth-stiffness-value">0.3</span>
              </div>
              <div class="control-group">
                <label>Gravity Strength:</label>
                <input type="range" id="gravity-strength" min="0.1" max="2" step="0.1" value="0.8" />
                <span id="gravity-strength-value">0.8</span>
              </div>
            </div>

            <div class="section">
              <h4>Debug & Testing</h4>
              <button id="debug-toggle" class="action-btn">ğŸ” Toggle Debug View</button>
              <button id="debug-log" class="action-btn">ğŸ“Š Log Physics Status</button>
              <button id="drop-test" class="action-btn">ğŸ¯ Drop Test</button>
              <button id="basic-test" class="action-btn">âš¡ Basic Test</button>
            </div>
          </div>

          <!-- Environment Tab -->
          <div id="environment-tab" class="tab-content">
            <h3>Environment & Lighting</h3>
            
            <div class="section">
              <h4>Environment Presets</h4>
              <div class="preset-grid">
                <button class="env-btn active" data-environment="studio">ğŸ¢ Studio</button>
                <button class="env-btn" data-environment="outdoor">ğŸŒ… Outdoor</button>
                <button class="env-btn" data-environment="neutral">âšª Neutral</button>
              </div>
            </div>

            <div class="section">
              <h4>Lighting Controls</h4>
              <div class="control-group">
                <label>Exposure:</label>
                <input type="range" id="exposure" min="0.5" max="2" step="0.1" value="1" />
                <span id="exposure-value">1</span>
              </div>
              <div class="control-group">
                <label>Shadow Intensity:</label>
                <input type="range" id="shadow-intensity" min="0" max="2" step="0.1" value="1" />
                <span id="shadow-intensity-value">1</span>
              </div>
              <div class="control-group">
                <label>Shadow Softness:</label>
                <input type="range" id="shadow-softness" min="0" max="1" step="0.1" value="0.5" />
                <span id="shadow-softness-value">0.5</span>
              </div>
            </div>

            <div class="section">
              <h4>Tone Mapping</h4>
              <div class="preset-grid">
                <button class="preset-btn active" data-tone-mapping="aces">ğŸ¨ ACES</button>
                <button class="preset-btn" data-tone-mapping="neutral">âšª Neutral</button>
                <button class="preset-btn" data-tone-mapping="commerce">ğŸ›ï¸ Commerce</button>
              </div>
            </div>

            <div class="section">
              <h4>Camera Controls</h4>
              <button id="auto-rotate-toggle" class="action-btn active">ğŸ”„ Auto Rotate</button>
              <button id="camera-reset" class="action-btn">ğŸ“· Reset Camera</button>
              <button id="focus-model" class="action-btn">ğŸ¯ Focus Model</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Center Panel - 3D Viewer -->
      <div class="center-panel">
        <!-- Model Type Selector -->
        <div class="model-selector">
          <button class="model-btn active" data-model-type="avatar">ğŸ‘¤ Avatar</button>
          <button class="model-btn" data-model-type="garment">ğŸ‘• Garment</button>
          <button class="model-btn" data-model-type="both">ğŸ¯ Combined</button>
        </div>

        <!-- 3D Viewer -->
        <div class="viewer-container">
          <model-viewer 
            id="main-viewer"
            camera-controls 
            touch-action="pan-y"
            auto-rotate
            auto-rotate-delay="3000"
            rotation-per-second="30deg"
            shadow-intensity="1"
            shadow-softness="0.5"
            exposure="1"
            tone-mapping="aces"
            environment-image="https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/1k/studio_small_03_1k.hdr"
            skybox-image="https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/1k/studio_small_03_1k.hdr">
          </model-viewer>
        </div>

        <!-- Physics Effect Indicator -->
        <div id="physics-effect-indicator" class="physics-effect-indicator">
          <div id="physics-effect-text">Physics Effect Active</div>
        </div>
      </div>

      <!-- Right Panel - Info -->
      <div class="right-panel">
        <div class="info-section">
          <h3>Model Information</h3>
          <div id="model-info" class="model-info">
            No model loaded
          </div>
        </div>

        <div class="info-section">
          <h3>Actions</h3>
          <button id="take-screenshot" class="action-btn">ğŸ“¸ Screenshot</button>
          <button id="export-scene" class="action-btn">ğŸ’¾ Export Scene</button>
        </div>

        <div class="info-section">
          <h3>Performance</h3>
          <div id="performance-info" class="performance-info">
            FPS: --<br>
            Triangles: --
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="main.js"></script>
</body>
</html>
